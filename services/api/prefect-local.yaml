# Prefect deployment configuration for CaptionA.cc flows (Local Development)
#
# Deploy all local flows:
#   cd services/api && uv run prefect deploy --all --prefect-file prefect-local.yaml
#
# Deploy specific local flow:
#   cd services/api && uv run prefect deploy -n captionacc-local-video-initial-processing --prefect-file prefect-local.yaml

# Default work pool for all local deployments
work_pool:
  name: captionacc-workers-local

# Local deployments use the local filesystem
pull: []

# Local Deployments (follows captionacc-{namespace}-{base_name} pattern)
deployments:
  - name: captionacc-local-video-initial-processing
    description: Extract frames and run OCR on uploaded videos
    entrypoint: app/flows/video_initial_processing.py:video_initial_processing
    work_pool:
      name: captionacc-workers-local
    schedules: []

  - name: captionacc-local-crop-and-infer-caption-frame-extents
    description: Crop frames and infer caption boundaries
    entrypoint: app/flows/crop_and_infer.py:crop_and_infer
    work_pool:
      name: captionacc-workers-local
    schedules: []

  - name: captionacc-local-caption-ocr
    description: Generate OCR for individual captions
    entrypoint: app/flows/caption_ocr.py:caption_ocr
    work_pool:
      name: captionacc-workers-local
    schedules: []

  - name: captionacc-local-process-new-videos
    description: "Process new videos (triggered by API)"
    entrypoint: app/flows/process_new_videos.py:process_new_videos
    work_pool:
      name: captionacc-workers-local
    schedules: []
