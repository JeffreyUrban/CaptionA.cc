# Prefect deployment configuration
name: captionacc-orchestrator

# Pull step: Get the code (local for development)
pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /Users/jurban/PycharmProjects/CaptionA.cc-claude3/services/orchestrator

# Deployments
deployments:
  - name: production
    entrypoint: flows/upload_and_process_video.py:upload_and_process_video_flow
    work_pool:
      name: captionacc-workers
    tags:
      - upload
      - processing
      - high-priority

  - name: production
    entrypoint: flows/layout_annotation.py:download_for_layout_annotation_flow
    work_pool:
      name: captionacc-workers
    tags:
      - download
      - layout-annotation
      - user-initiated

  - name: production
    entrypoint: flows/layout_annotation.py:upload_layout_db_flow
    work_pool:
      name: captionacc-workers
    tags:
      - upload
      - layout-annotation
      - user-initiated
      - high-priority

  - name: production
    entrypoint: flows/crop_frames_to_webm.py:crop_frames_to_webm_flow
    work_pool:
      name: captionacc-workers
    tags:
      - crop-frames
      - webm
      - user-initiated
      - high-priority

  - name: production
    entrypoint: flows/caption_annotation.py:download_for_caption_annotation_flow
    work_pool:
      name: captionacc-workers
    tags:
      - download
      - caption-annotation
      - user-initiated

  - name: production
    entrypoint: flows/caption_annotation.py:upload_captions_db_flow
    work_pool:
      name: captionacc-workers
    tags:
      - upload
      - caption-annotation
      - user-initiated
      - high-priority

  - name: production
    entrypoint: flows/video_processing.py:process_video_initial_flow
    work_pool:
      name: captionacc-workers
    tags:
      - background
      - full-frames

  - name: production
    entrypoint: flows/crop_frames.py:crop_frames_flow
    work_pool:
      name: captionacc-workers
    tags:
      - user-initiated
      - crop-frames

  - name: production
    entrypoint: flows/caption_median_ocr.py:caption_median_ocr_flow
    work_pool:
      name: captionacc-workers
    tags:
      - user-initiated
      - median-ocr

  - name: production
    entrypoint: flows/base_model_update.py:base_model_update_flow
    work_pool:
      name: captionacc-workers
    tags:
      - admin
      - base-model

  - name: production
    entrypoint: flows/video_model_retrain.py:retrain_video_model_flow
    work_pool:
      name: captionacc-workers
    tags:
      - model-retrain
      - medium-priority
